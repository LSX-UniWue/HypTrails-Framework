apiVersion: batch/v1
kind: Job
metadata:
  name: match-semantic-scholar
spec:
  backoffLimit: 0
  template:
    spec:
      containers:
        - name: match-semantic-scholar
          image: ls6-staff-registry.informatik.uni-wuerzburg.de/koopmann/hydras:latest
          resources:
            limits:
              cpu: 1
              nvidia.com/gpu: "1"
              memory: "50Gi"
            requests:
              cpu: 1
              nvidia.com/gpu: "1"
              memory: "50Gi"
          imagePullPolicy: "Always"
          volumeMounts:
            - mountPath: "/workdir/"
              name: home
            - mountPath: "/workdir/data/bibliometric_dataset/semantic_scholar"
              name: scholar
          env:
            - name: HOME
              value: "/workdir/"
          command: ["/bin/bash",  "-c", "python3 -u -m debugpy --listen 0.0.0.0:4444 mycode/extract_dblp_dataset/create_dataset.py"]
      restartPolicy: Never
      imagePullSecrets:
        - name: ls6-staff-registry
      volumes:
        - name: home
          cephfs:
            monitors:
              - 132.187.14.16
              - 132.187.14.17
              - 132.187.14.19
              - 132.187.14.20
            user: koopmann
            path: "/home/ls6/koopmann/code-2023-hydras"
            secretRef:
              name: ceph-secret
        - name: scholar
          cephfs:
            monitors:
              - 132.187.14.16
              - 132.187.14.17
              - 132.187.14.19
              - 132.187.14.20
            user: koopmann
            path: "/home/ls6/koopmann/semantic_scholar"
            secretRef:
              name: ceph-secret
